(function(e){function y(a,r){return parseInt(e.css(a[0],r))||0}function G(a){return a[0].offsetHeight+y(a,"marginTop")+y(a,"marginBottom")}e.fn.jMyCarousel=function(a){a=e.extend({btnPrev:null,btnNext:null,mouseWheel:!0,auto:!1,speed:500,easing:"linear",vertical:!1,circular:!0,visible:"4",start:0,scroll:1,step:50,eltByElt:!1,evtStart:"mouseover touchstart",evtStop:"mouseout touchend",beforeStart:null,afterEnd:null},a||{});return this.each(function(){function r(w,b){var c=w?w:s;if(!(!0===g&&"backward"===
n)){if(!a.circular&&d+c+(a.vertical?z:m)>t)c=t-(d+(a.vertical?z:m));k.animate("left"==A?{left:-(d+c)}:{top:-(d+c)},a.speed,a.easing,function(){d+=c;if(a.circular&&d+(a.vertical?z:m)+f>=J)k.css(a.vertical?"top":"left",-d+t),d-=t;!b&&g?(r(),console.log("forward")):b&&(0<--B?r(s,!0):(g=!1,n=null))})}}function C(w,b){var c=w?w:s;!0===g&&"forward"===n||(a.circular||0>d-c&&(c=d-0),k.animate("left"==A?{left:-(d-c)}:{top:-(d-c)},a.speed,a.easing,function(){d-=c;a.circular&&d<=f&&(k.css(a.vertical?"top":"left",
-(d+t)),d+=t);!b&&g?C():b&&(0<--B?C(s,!0):(g=!1,n=null))}))}function H(){a.eltByElt||(k.stop(),d=0-parseInt(k.css(A)));g=!1;n=null}function K(b){var c=b.find("img");return a.vertical?parseInt(b.css("margin-left"))+parseInt(b.css("margin-right"))+parseInt(c.width())+parseInt(b.css("border-left-width"))+parseInt(b.css("border-right-width"))+parseInt(b.css("padding-right"))+parseInt(b.css("padding-left")):parseInt(b.css("margin-top"))+parseInt(b.css("margin-bottom"))+parseInt(c.width())+parseInt(b.css("border-top-height"))+
parseInt(b.css("border-bottom-height"))+parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom"))}var g=!1,A=a.vertical?"top":"left",E=a.vertical?"height":"width",l=e(this),k=e("ul",l),b=e("li",k),u=b.length,h=a.visible,B=0,p=null===a.btnNext&&null===a.btnPrev?!0:!1,F=-1!=h.toString().indexOf("%")?"%":-1!=h.toString().indexOf("px")?"px":"el",n=null;a.speed=Math.max(20,a.speed);a.circular&&(b=b.clone(),k.prepend(b).append(b.clone()));b=e("li",k);l.css("visibility","visible");b.css("overflow",
"hidden").css("float",a.vertical?"none":"left").children().css("overflow","hidden");a.vertical||b.css("display","inline");"a"==b.children().get(0).tagName.toLowerCase()&&!a.vertical&&b.children().css("float","left");a.vertical&&jQuery.browser.msie&&b.css("line-height","4px").children().css("margin-bottom","-4px");k.css("margin","0").css("padding","0").css("position","relative").css("list-style-type","none").css("z-index","1");l.css("overflow","hidden").css("position","relative").css("z-index","2").css("left",
"0px");var f=a.vertical?G(b):b[0].offsetWidth+y(b,"marginLeft")+y(b,"marginRight"),q=a.vertical?K(b):G(b),d=a.start,c=b.length,I=f*c,t=u*f,J=c*f,s="default"==a.step?f:a.step;a.btnPrev=p?e('<input type="button" class="'+(a.vertical?"up":"prev")+'" />'):e(a.btnPrev);a.btnNext=p?e('<input type="button" class="'+(a.vertical?"down":"next")+'" />'):e(a.btnNext);var c=a.btnPrev,v=a.btnNext;p&&!0!==a.auto&&(c.css({opacity:"0.6"}),v.css({opacity:"0.6"}),l.prepend(c),l.prepend(v),a.btnPrev=c,a.btnNext=v);if(a.eltByElt&&
(s=f,0!==a.start%f))var x=parseInt(a.start/f),d=a.start=x*f;a.circular&&(a.start+=f*u,d+=f*u);var m,D;"%"==F?(m=0,x=parseInt(h),D="%"):("px"==F?(m=parseInt(h),x=parseInt(h)):(m=f*parseInt(h),x=f*parseInt(h)),D="px");k.css(E,I+"px").css(A,-a.start);l.css(E,x+D);a.vertical&&"%"==D&&(u=f*u*(parseInt(h)/100),l.css(E,u+"px"));0===m&&(m=l.width());a.vertical?(l.css("width",q+"px"),k.css("width",q+"px"),b.css("margin-bottom",2*parseInt(b.css("margin-bottom"))+"px"),b.eq(b.length-1).css("margin-bottom",b.css("margin-top"))):
(l.css("height",q+"px"),k.css("height",q+"px"));"%"==F&&(h=m/b.width(),0!==h%1&&(h+=1),h=parseInt(h));var z=l.height();p&&(v.css({"z-index":200,position:"absolute"}),c.css({"z-index":200,position:"absolute"}),a.vertical?(c.css({width:c.width(),height:c.height(),top:"0px",left:parseInt(q/2)-parseInt(c.width()/2)+"px"}),v.css({width:c.width(),height:c.height(),top:z-c.height()+"px",left:parseInt(q/2)-parseInt(c.width()/2)+"px"})):(c.css({left:"0px",top:parseInt(q/2)-parseInt(c.height()/2)+"px"}),v.css({right:"0px",
top:parseInt(q/2)-parseInt(c.height()/2)+"px"})));a.btnPrev&&(e(a.btnPrev).on(a.evtStart,function(b){b.preventDefault();p&&a.btnPrev.css("opacity",0.9);g=!0;n="backward";return C()}),e(a.btnPrev).on(a.evtStop,function(b){b.preventDefault();p&&a.btnPrev.css("opacity",0.6);g=!1;n=null;return H()}));a.btnNext&&(e(a.btnNext).on(a.evtStart,function(b){b.preventDefault();p&&a.btnNext.css("opacity",0.9);g=!0;n="forward";return r()}),e(a.btnNext).on(a.evtStop,function(b){b.preventDefault();p&&a.btnNext.css("opacity",
0.6);g=!1;n=null;return H()}));!0===a.auto&&(g=!0,r());a.mouseWheel&&l.mousewheel&&l.mousewheel(function(b,c){if(!a.circular&&(0<c?d+m<I:0<d)||a.circular)B+=1,!1===g&&(0<c?r(s,!0):C(s,!0),g=!0)})})}})(jQuery);
